name: Feature Request Handler

on:
  issues:
    types: [opened, labeled]

jobs:
  post-to-discord:
    runs-on: ubuntu-latest
    if: contains(github.event.issue.labels.*.name, 'feature-request') || contains(github.event.issue.title, 'Feature Request')
    steps:
      - name: Post to Discord
        run: |
          ISSUE_TITLE="${{ github.event.issue.title }}"
          ISSUE_BODY="${{ github.event.issue.body }}"
          ISSUE_URL="${{ github.event.issue.html_url }}"
          ISSUE_NUMBER="${{ github.event.issue.number }}"
          
          # Webhook for #jackbot-discoveries
          DISCORD_WEBHOOK="https://discord.com/api/webhooks/1466251414132097209/9Oom_K9RubslhIUn1lPiYmq9FG15UI_aFsPHB6gzyCQrxenfamdywRu_l2FB2OkRVL8q"
          
          curl -X POST "$DISCORD_WEBHOOK" \
            -H "Content-Type: application/json" \
            -d "{
              \"embeds\": [{
                \"title\": \"ðŸ”­ New Feature Request\",
                \"description\": \"${ISSUE_BODY}\",
                \"url\": \"${ISSUE_URL}\",
                \"color\": 5205895,
                \"fields\": [
                  {\"name\": \"Source\", \"value\": \"overhead-flights\", \"inline\": true},
                  {\"name\": \"Issue\", \"value\": \"#${ISSUE_NUMBER}\", \"inline\": true}
                ],
                \"footer\": {\"text\": \"Overhead Flights â€¢ GitHub Issues\"}
              }]
            }"
